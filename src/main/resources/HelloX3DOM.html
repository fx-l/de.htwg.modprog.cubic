<html> 
   <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/> 
     <title>Cubic 4x4x4</title> 
     <script type='text/javascript' src='http://www.x3dom.org/download/x3dom.js'> </script> 
     <link rel='stylesheet' type='text/css' href='http://www.x3dom.org/download/x3dom.css'></link>
     <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.0.min.js" ></script>
	 <script>
	 
	 var scale = 5;
	 var gridCoords = [0, -1, 0, 1 * scale, -1, 0, 2 * scale, -1, 0, 3 * scale, -1, 0, 3 * scale, -1, 1 * scale, 3 * scale, -1, 2 * scale, 3 * scale, -1, 3 * scale, 2 * scale, -1, 3 * scale, 1 * scale, -1, 3 * scale, 0, -1, 3 * scale, 0, -1, 2 * scale, 0, -1, 1 * scale];
	 
	function createScene() {

		var scene = document.getElementById("scene");
				
		for(var y = 0; y <= 3; y++) {
			var grid = createGrid(y);
			scene.appendChild(grid);
		}	
		
		for (var x = 0; x <= 3; x++) {
			for (var y = 0; y <= 3; y++) {
				for (var z = 0; z <= 3; z++) {
					var sphere = createSpheres(x, y, z);
					scene.appendChild(sphere);
				}
			}
		}	
	}
	    	
	function handleColorAndSizeChange(shape,event)
    	{
		$('#marker').attr('translation', event.hitPnt);
    	$('#lastClickedObject').html($(shape).attr("DEF"));
		$(shape).find('material').prop('diffuseColor', 'blue');
		$(shape).parent('transform').prop('scale', '.95 .95 .95');
    	}
	
	function createSpheres(x, y, z) {
		// transform element
		var transform = document.createElement("transform");
		var coords = x * scale + " " + y * scale + " " + z * scale;
		//var coords = x + " " + y + " " + z;
		transform.setAttribute("scale", ".55 .55 .55");
		transform.setAttribute("translation", coords);
		// shape element
		var shape = document.createElement("shape");
		shape.setAttribute("DEF", x + " " + y + " " + z);
		shape.setAttribute("onclick","handleColorAndSizeChange(this,event)");
		transform.appendChild(shape);
		// appearance element
		var appearance = document.createElement("appearance");
		shape.appendChild(appearance);
		// sphere element
		var sphere = document.createElement("sphere");
		shape.appendChild(sphere);
		// material element
		var material = document.createElement("material");
		material.setAttribute("transparency", "0.2");
		// color of material...
		material.setAttribute("diffuseColor", "black");
		appearance.appendChild(material);
		
		return transform;
	}
	
	function createGrid(y) {
		var realGridCoords = gridCoords.map(function(num) {
			if(num == -1) { return y * scale } else { return num };
		});
		var gridCoordsString = realGridCoords.join([separator = ' ']);
		// create dom
		var shape = document.createElement("shape");
		// appearance element
		var appearance = document.createElement("appearance");
		shape.appendChild(appearance);
		// material element
		var material = document.createElement("material");
		material.setAttribute("diffuseColor", "black");
		appearance.appendChild(material);
		// indexedlineset element
		var lineset = document.createElement("indexedlineset");
		lineset.setAttribute("coordindex", "0 3 6 9 0 -1 1 8 -1 2 7 -1 4 11 -1 5 10 -1");
		shape.appendChild(lineset);
		// coordinate element
		var coord = document.createElement("coordinate");
		coord.setAttribute("point", gridCoordsString);
		lineset.appendChild(coord);
		
		return shape;
	}
	
	</script>
   </head> 
   <body onload="createScene()"> 
     <h1>Cubic 4x4</h1> 
	 <x3d width='500px' height='500px'> 
	   <scene id="scene">
	   <Viewpoint centerOfRotation="7.5 7.5 7.5" position="7.5 7.5 55" orientation="0 0 1"
	 description="camera"></Viewpoint>
	   <navigationInfo type='"examine" "all"' id="navType"></navigationInfo>
	<Transform id="marker" scale=".15 .15 .15" translation="1000 0 0">
            <Shape>
                <Appearance>
                    <Material diffuseColor="#FFD966"></Material>
                </Appearance>
                <Sphere></Sphere>
            </Shape>
        </Transform>
	   </scene> 
	</x3d>
	<div style="position:absolute;left:600px;top:70px;width:200px">
	<h3>Koordinaten (x-Achse, y-Achse, z-Achse):</h3> 
	<span id="lastClickedObject">-</span>
</div>
   </body> 
</html>